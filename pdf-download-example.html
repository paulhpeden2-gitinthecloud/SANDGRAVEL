<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PDF Download to Form - Example</title>
    <style>
        body {
            font-family: 'Courier New', monospace;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
            background: #1a1a1a;
            color: #ecf0f1;
        }

        h1 {
            color: #d2b48c;
            border-bottom: 2px solid #d2b48c;
            padding-bottom: 10px;
        }

        .example-section {
            background: rgba(255, 255, 255, 0.05);
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            border: 1px solid rgba(210, 180, 140, 0.3);
        }

        .code-block {
            background: #000;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
            margin: 10px 0;
            border-left: 4px solid #d2b48c;
        }

        code {
            color: #50fa7b;
            font-size: 14px;
        }

        .download-link {
            display: inline-block;
            padding: 10px 20px;
            background: rgba(194, 178, 128, 0.3);
            color: #ecf0f1;
            text-decoration: none;
            border-radius: 8px;
            border: 2px solid rgba(210, 180, 140, 0.5);
            margin: 10px 5px;
            transition: all 0.3s ease;
        }

        .download-link:hover {
            background: rgba(194, 178, 128, 0.6);
            transform: translateY(-2px);
        }

        .warning {
            background: rgba(231, 76, 60, 0.1);
            border-left: 4px solid #e74c3c;
            padding: 15px;
            margin: 15px 0;
            border-radius: 5px;
        }

        .info {
            background: rgba(52, 152, 219, 0.1);
            border-left: 4px solid #3498db;
            padding: 15px;
            margin: 15px 0;
            border-radius: 5px;
        }

        .success {
            background: rgba(46, 204, 113, 0.1);
            border-left: 4px solid #2ecc71;
            padding: 15px;
            margin: 15px 0;
            border-radius: 5px;
        }

        ol {
            line-height: 1.8;
        }

        li {
            margin: 10px 0;
        }
    </style>
</head>
<body>
    <h1>üìÑ How to Download PDFs Directly to the Form</h1>

    <div class="info">
        <strong>Question:</strong> Can clicking a PDF link automatically download it to the form?<br>
        <strong>Answer:</strong> Yes! But with some important limitations due to browser security.
    </div>

    <div class="example-section">
        <h2>Method 1: Click-to-Download and Auto-Add (Recommended)</h2>

        <p>This method downloads the PDF and automatically adds it to the form's file list.</p>

        <h3>Step 1: Add this function to your sand-gravel-uploader.html</h3>
        <div class="code-block">
            <code>
// Add this function anywhere in the &lt;script&gt; section<br>
async function downloadAndAddPDF(url, filename) {<br>
&nbsp;&nbsp;&nbsp;&nbsp;try {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// Show loading status<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;showStatus('Downloading PDF...', 'processing');<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// Fetch the PDF<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;const response = await fetch(url);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (!response.ok) throw new Error('Download failed');<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// Convert to blob<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;const blob = await response.blob();<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// Create File object<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;const file = new File([blob], filename, { type: 'application/pdf' });<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// Add to selected files using existing handler<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;handleFiles([file]);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;showStatus('PDF downloaded and added!', 'success');<br>
&nbsp;&nbsp;&nbsp;&nbsp;} catch (error) {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;console.error('Download error:', error);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;showStatus('Failed to download PDF', 'error');<br>
&nbsp;&nbsp;&nbsp;&nbsp;}<br>
}
            </code>
        </div>

        <h3>Step 2: Create download links</h3>
        <div class="code-block">
            <code>
&lt;!-- Add links anywhere on your page --&gt;<br>
&lt;button onclick="downloadAndAddPDF('https://example.com/permit1.pdf', 'permit1.pdf')"&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;üì• Add Permit #1<br>
&lt;/button&gt;<br>
<br>
&lt;button onclick="downloadAndAddPDF('https://example.com/permit2.pdf', 'permit2.pdf')"&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;üì• Add Permit #2<br>
&lt;/button&gt;
            </code>
        </div>

        <h3>Live Demo:</h3>
        <p>These buttons demonstrate the concept (they won't actually work here, but show the interaction):</p>
        <a href="#" class="download-link" onclick="alert('In the real form, this would download and add the PDF!'); return false;">
            üì• Download Sample Permit 1
        </a>
        <a href="#" class="download-link" onclick="alert('In the real form, this would download and add the PDF!'); return false;">
            üì• Download Sample Permit 2
        </a>
    </div>

    <div class="warning">
        <strong>‚ö†Ô∏è Important Security Limitations:</strong>
        <ul>
            <li>The PDF must be on the <strong>same domain</strong> as your form OR have CORS enabled</li>
            <li>You cannot download from random websites due to browser security (CORS policy)</li>
            <li>If the PDFs are on a different server, that server must allow cross-origin requests</li>
        </ul>
    </div>

    <div class="example-section">
        <h2>Method 2: Email/List Page with Download Links</h2>

        <p>Create a separate page that lists all PDFs with quick-add buttons:</p>

        <div class="code-block">
            <code>
&lt;!DOCTYPE html&gt;<br>
&lt;html&gt;<br>
&lt;head&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;title&gt;PDF Download List&lt;/title&gt;<br>
&lt;/head&gt;<br>
&lt;body&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;h1&gt;Available Permits&lt;/h1&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;ul&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;li&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ABC Sand & Gravel - Permit #12345<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;button onclick="parent.downloadAndAddPDF('permits/abc-12345.pdf', 'ABC-12345.pdf')"&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Add to Form<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/button&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/li&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;li&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XYZ Quarry - Permit #67890<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;button onclick="parent.downloadAndAddPDF('permits/xyz-67890.pdf', 'XYZ-67890.pdf')"&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Add to Form<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/button&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/li&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/ul&gt;<br>
&lt;/body&gt;<br>
&lt;/html&gt;
            </code>
        </div>
    </div>

    <div class="example-section">
        <h2>Method 3: Email with Direct Links (Simple Workaround)</h2>

        <p>If the PDFs are on a web server, send email links like this:</p>

        <div class="code-block">
            <code>
&lt;!-- In your email template --&gt;<br>
Dear Facility Manager,<br>
<br>
Click the links below to add permits to the processor:<br>
<br>
&lt;a href="https://yourdomain.com/sand-gravel-uploader.html?download=permit1.pdf"&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;Add Permit #12345<br>
&lt;/a&gt;<br>
<br>
&lt;a href="https://yourdomain.com/sand-gravel-uploader.html?download=permit2.pdf"&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;Add Permit #67890<br>
&lt;/a&gt;
            </code>
        </div>

        <h3>Then add URL parameter detection to your form:</h3>
        <div class="code-block">
            <code>
// Add this at the bottom of your &lt;script&gt; section<br>
window.addEventListener('DOMContentLoaded', () => {<br>
&nbsp;&nbsp;&nbsp;&nbsp;const urlParams = new URLSearchParams(window.location.search);<br>
&nbsp;&nbsp;&nbsp;&nbsp;const downloadUrl = urlParams.get('download');<br>
&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;if (downloadUrl) {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// Auto-download the PDF when page loads<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;const baseUrl = 'https://yourdomain.com/permits/';<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;downloadAndAddPDF(baseUrl + downloadUrl, downloadUrl);<br>
&nbsp;&nbsp;&nbsp;&nbsp;}<br>
});
            </code>
        </div>
    </div>

    <div class="success">
        <h3>‚úÖ Best Practice Workflow:</h3>
        <ol>
            <li>Store all PDFs on your web server (same domain as the form)</li>
            <li>Create a simple list page with "Add to Form" buttons for each PDF</li>
            <li>Or embed download buttons directly in your emails</li>
            <li>Users click the button ‚Üí PDF downloads and auto-adds to the form</li>
            <li>Users can add multiple PDFs, then click "Process PDFs" once</li>
        </ol>
    </div>

    <div class="example-section">
        <h2>Complete Integration Example</h2>

        <p>Here's the complete code to add to your sand-gravel-uploader.html:</p>

        <div class="code-block">
            <code>
&lt;!-- Add this HTML before the &lt;/div&gt; that closes .container --&gt;<br>
&lt;div style="margin-top: 30px; padding: 20px; background: rgba(194, 178, 128, 0.1); border-radius: 10px;"&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;h3 style="margin-top: 0; color: #d2b48c;"&gt;Quick Add from Server&lt;/h3&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;div id="quickAddButtons"&gt;&lt;/div&gt;<br>
&lt;/div&gt;<br>
<br>
&lt;!-- Add this JavaScript function --&gt;<br>
&lt;script&gt;<br>
// Download and add PDF function<br>
async function downloadAndAddPDF(url, filename) {<br>
&nbsp;&nbsp;&nbsp;&nbsp;try {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;showStatus('Downloading ' + filename + '...', 'processing');<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;const response = await fetch(url);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (!response.ok) throw new Error('Download failed');<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;const blob = await response.blob();<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;const file = new File([blob], filename, { type: 'application/pdf' });<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;handleFiles([file]);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;showStatus('‚úÖ ' + filename + ' added!', 'success');<br>
&nbsp;&nbsp;&nbsp;&nbsp;} catch (error) {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;showStatus('‚ùå Failed to download ' + filename, 'error');<br>
&nbsp;&nbsp;&nbsp;&nbsp;}<br>
}<br>
<br>
// Example: Add quick-add buttons for common PDFs<br>
const pdfList = [<br>
&nbsp;&nbsp;&nbsp;&nbsp;{ url: 'https://yourdomain.com/permits/permit1.pdf', name: 'Permit #12345' },<br>
&nbsp;&nbsp;&nbsp;&nbsp;{ url: 'https://yourdomain.com/permits/permit2.pdf', name: 'Permit #67890' }<br>
];<br>
<br>
const quickAddDiv = document.getElementById('quickAddButtons');<br>
pdfList.forEach(pdf => {<br>
&nbsp;&nbsp;&nbsp;&nbsp;const btn = document.createElement('button');<br>
&nbsp;&nbsp;&nbsp;&nbsp;btn.className = 'upload-btn';<br>
&nbsp;&nbsp;&nbsp;&nbsp;btn.style.margin = '5px';<br>
&nbsp;&nbsp;&nbsp;&nbsp;btn.textContent = 'üì• ' + pdf.name;<br>
&nbsp;&nbsp;&nbsp;&nbsp;btn.onclick = () => downloadAndAddPDF(pdf.url, pdf.name + '.pdf');<br>
&nbsp;&nbsp;&nbsp;&nbsp;quickAddDiv.appendChild(btn);<br>
});<br>
&lt;/script&gt;
            </code>
        </div>
    </div>

    <div class="info">
        <h3>üìå Key Points:</h3>
        <ul>
            <li><strong>Same Origin:</strong> PDFs must be on the same domain or have CORS enabled</li>
            <li><strong>User Action:</strong> Download must be triggered by user click (not automatic on page load for security)</li>
            <li><strong>File API:</strong> Uses modern JavaScript File API to create file objects</li>
            <li><strong>Existing Handler:</strong> Reuses your existing handleFiles() function</li>
            <li><strong>Visual Feedback:</strong> Shows status messages during download</li>
        </ul>
    </div>

</body>
</html>
